{"ast":null,"code":"\"use strict\";\n\nvar _slicedToArray = require(\"@babel/runtime/helpers/slicedToArray\");\nvar _toConsumableArray = require(\"@babel/runtime/helpers/toConsumableArray\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.isRuleSetItem = exports.getPluginsByName = exports.getPlugins = exports.conditionMatchesFile = exports.rulesMatchAnyFiles = exports.getRulesByMatchingFiles = exports.getRulesFromRules = exports.getExpoBabelLoader = exports.getRules = exports.getRulesAsItems = void 0;\nvar util_1 = require(\"util\");\nfunction getRulesAsItems(rules) {\n  return rules.map(function (rule, index) {\n    return {\n      index: index,\n      rule: rule\n    };\n  });\n}\nexports.getRulesAsItems = getRulesAsItems;\nfunction getRules(config) {\n  var _ref = config.module || {},\n    _ref$rules = _ref.rules,\n    rules = _ref$rules === void 0 ? [] : _ref$rules;\n  return getRulesAsItems(getRulesFromRules(rules));\n}\nexports.getRules = getRules;\nfunction getExpoBabelLoader(config) {\n  var _a, _b;\n  var _ref2 = config.module || {},\n    _ref2$rules = _ref2.rules,\n    rules = _ref2$rules === void 0 ? [] : _ref2$rules;\n  var currentRules = getRulesAsItems(getRulesFromRules(rules));\n  for (var ruleItem of currentRules) {\n    var rule = ruleItem.rule;\n    if (rule.use && typeof rule.use === 'object' && ((_b = (_a = rule.use.options) === null || _a === void 0 ? void 0 : _a.caller) === null || _b === void 0 ? void 0 : _b.__dangerous_rule_id) === 'expo-babel-loader') {\n      return rule;\n    }\n  }\n  return null;\n}\nexports.getExpoBabelLoader = getExpoBabelLoader;\nfunction getRulesFromRules(rules) {\n  var output = [];\n  for (var rule of rules) {\n    if (rule !== '...') {\n      if (rule.oneOf) {\n        output.push.apply(output, _toConsumableArray(getRulesFromRules(rule.oneOf)));\n      } else {\n        output.push(rule);\n      }\n    }\n  }\n  return output;\n}\nexports.getRulesFromRules = getRulesFromRules;\nfunction getRulesByMatchingFiles(config, files) {\n  var rules = getRules(config);\n  var selectedRules = {};\n  var _loop = function _loop(file) {\n    selectedRules[file] = rules.filter(function (_ref3) {\n      var rule = _ref3.rule;\n      return conditionMatchesFile(rule.test, file);\n    });\n  };\n  for (var file of files) {\n    _loop(file);\n  }\n  return selectedRules;\n}\nexports.getRulesByMatchingFiles = getRulesByMatchingFiles;\nfunction rulesMatchAnyFiles(config, files) {\n  var rules = getRulesByMatchingFiles(config, files);\n  return Object.keys(rules).some(function (filename) {\n    return !!rules[filename].length;\n  });\n}\nexports.rulesMatchAnyFiles = rulesMatchAnyFiles;\nfunction conditionMatchesFile(condition, file) {\n  if (!condition) return false;\n  if ((0, util_1.isRegExp)(condition)) {\n    return condition.test(file);\n  } else if (typeof condition === 'string') {\n    return file.startsWith(condition);\n  } else if (typeof condition === 'function') {\n    return Boolean(condition(file));\n  } else if (Array.isArray(condition)) {\n    return condition.some(function (c) {\n      return conditionMatchesFile(c, file);\n    });\n  }\n  return Object.entries(condition).map(function (_ref4) {\n    var _ref5 = _slicedToArray(_ref4, 2),\n      key = _ref5[0],\n      value = _ref5[1];\n    switch (key) {\n      case 'test':\n        return conditionMatchesFile(value, file);\n      case 'include':\n        return conditionMatchesFile(value, file);\n      case 'exclude':\n        return !conditionMatchesFile(value, file);\n      case 'and':\n        return value.every(function (c) {\n          return conditionMatchesFile(c, file);\n        });\n      case 'or':\n        return value.some(function (c) {\n          return conditionMatchesFile(c, file);\n        });\n      case 'not':\n        return value.every(function (c) {\n          return !conditionMatchesFile(c, file);\n        });\n      default:\n        return true;\n    }\n  }).every(function (b) {\n    return b;\n  });\n}\nexports.conditionMatchesFile = conditionMatchesFile;\nfunction getPlugins(_ref6) {\n  var _ref6$plugins = _ref6.plugins,\n    plugins = _ref6$plugins === void 0 ? [] : _ref6$plugins;\n  return plugins.map(function (plugin, index) {\n    return {\n      index: index,\n      plugin: plugin\n    };\n  });\n}\nexports.getPlugins = getPlugins;\nfunction getPluginsByName(config, name) {\n  return getPlugins(config).filter(function (_ref7) {\n    var plugin = _ref7.plugin;\n    if (plugin && plugin.constructor) {\n      return plugin.constructor.name === name;\n    }\n    return false;\n  });\n}\nexports.getPluginsByName = getPluginsByName;\nfunction isRuleSetItem(loader) {\n  return typeof loader === 'string' || typeof loader === 'function';\n}\nexports.isRuleSetItem = isRuleSetItem;","map":{"version":3,"names":["util_1","require","getRulesAsItems","rules","map","rule","index","exports","getRules","config","_ref","module","_ref$rules","getRulesFromRules","getExpoBabelLoader","_ref2","_ref2$rules","currentRules","ruleItem","use","_b","_a","options","caller","__dangerous_rule_id","output","oneOf","push","apply","_toConsumableArray","getRulesByMatchingFiles","files","selectedRules","_loop","file","filter","_ref3","conditionMatchesFile","test","rulesMatchAnyFiles","Object","keys","some","filename","length","condition","isRegExp","startsWith","Boolean","Array","isArray","c","entries","_ref4","_ref5","_slicedToArray","key","value","every","b","getPlugins","_ref6","_ref6$plugins","plugins","plugin","getPluginsByName","name","_ref7","constructor","isRuleSetItem","loader"],"sources":["/Users/henriqueeidt/Documents/Projects/poc-web-mobile-components/component-library/node_modules/@expo/webpack-config/src/utils/search.ts"],"sourcesContent":["/**\n * Loader flattening inspired by:\n * https://github.com/preactjs/preact-cli-experiment/tree/7b80623/packages/cli-plugin-legacy-config\n */\nimport { isRegExp } from 'util';\nimport {\n  Configuration,\n  RuleSetCondition,\n  RuleSetRule,\n  RuleSetUse,\n  RuleSetUseItem,\n  WebpackPluginInstance,\n} from 'webpack';\n\ninterface RuleItem {\n  rule: RuleSetRule;\n  index: number;\n}\n\ninterface PluginItem {\n  plugin: WebpackPluginInstance;\n  index: number;\n}\n\n/**\n *\n * @param rules\n * @category utils\n */\nexport function getRulesAsItems(rules: RuleSetRule[]): RuleItem[] {\n  return rules.map((rule, index) => ({\n    index,\n    rule,\n  }));\n}\n\n/**\n *\n * @param config\n * @category utils\n */\nexport function getRules(config: Configuration): RuleItem[] {\n  const { rules = [] } = config.module || {};\n  return getRulesAsItems(getRulesFromRules(rules));\n}\n\n/**\n * Get the babel-loader rule created by `@expo/webpack-config/loaders`\n *\n * @param config\n * @category utils\n */\nexport function getExpoBabelLoader(config: Configuration): RuleSetRule | null {\n  const { rules = [] } = config.module || {};\n  const currentRules = getRulesAsItems(getRulesFromRules(rules));\n  for (const ruleItem of currentRules) {\n    const rule: any = ruleItem.rule;\n    if (\n      rule.use &&\n      typeof rule.use === 'object' &&\n      rule.use.options?.caller?.__dangerous_rule_id === 'expo-babel-loader'\n    ) {\n      return rule;\n    }\n  }\n  return null;\n}\n\n/**\n *\n * @param rules\n * @category utils\n */\nexport function getRulesFromRules(rules: (RuleSetRule | '...')[]): RuleSetRule[] {\n  const output: RuleSetRule[] = [];\n\n  for (const rule of rules) {\n    if (rule !== '...') {\n      if (rule.oneOf) {\n        output.push(...getRulesFromRules(rule.oneOf));\n      } else {\n        output.push(rule);\n      }\n    }\n  }\n  return output;\n}\n\n/**\n *\n * @param config\n * @param files\n * @category utils\n */\nexport function getRulesByMatchingFiles(\n  config: Configuration,\n  files: string[]\n): { [key: string]: RuleItem[] } {\n  const rules = getRules(config);\n  const selectedRules: { [key: string]: RuleItem[] } = {};\n  for (const file of files) {\n    selectedRules[file] = rules.filter(({ rule }) => conditionMatchesFile(rule.test, file));\n  }\n  return selectedRules;\n}\n\n/**\n *\n * @param config\n * @param files\n * @category utils\n */\nexport function rulesMatchAnyFiles(config: Configuration, files: string[]): boolean {\n  const rules = getRulesByMatchingFiles(config, files);\n  return Object.keys(rules).some(filename => !!rules[filename].length);\n}\n\n/**\n *\n * @param condition\n * @param file\n * @category utils\n */\nexport function conditionMatchesFile(\n  condition: RuleSetCondition | undefined,\n  file: string\n): boolean {\n  if (!condition) return false;\n  if (isRegExp(condition)) {\n    return condition.test(file);\n  } else if (typeof condition === 'string') {\n    return file.startsWith(condition);\n  } else if (typeof condition === 'function') {\n    return Boolean(condition(file));\n  } else if (Array.isArray(condition)) {\n    return condition.some(c => conditionMatchesFile(c, file));\n  }\n  return Object.entries(condition)\n    .map(([key, value]) => {\n      switch (key) {\n        case 'test':\n          return conditionMatchesFile(value, file);\n        case 'include':\n          return conditionMatchesFile(value, file);\n        case 'exclude':\n          return !conditionMatchesFile(value, file);\n        case 'and':\n          return (value as RuleSetCondition[]).every(c => conditionMatchesFile(c, file));\n        case 'or':\n          return (value as RuleSetCondition[]).some(c => conditionMatchesFile(c, file));\n        case 'not':\n          return (value as RuleSetCondition[]).every(c => !conditionMatchesFile(c, file));\n        default:\n          return true;\n      }\n    })\n    .every(b => b);\n}\n\n/**\n *\n * @param param0\n * @category utils\n */\nexport function getPlugins({ plugins = [] }: Configuration): PluginItem[] {\n  return plugins.map((plugin, index) => ({ index, plugin }));\n}\n\n/**\n *\n * @param config\n * @param name\n * @category utils\n */\nexport function getPluginsByName(config: Configuration, name: string): PluginItem[] {\n  return getPlugins(config).filter(({ plugin }: PluginItem) => {\n    if (plugin && plugin.constructor) {\n      return plugin.constructor.name === name;\n    }\n    return false;\n  });\n}\n\n/**\n *\n * @param loader\n * @category utils\n */\nexport function isRuleSetItem(loader: RuleSetUse): loader is RuleSetUseItem {\n  return typeof loader === 'string' || typeof loader === 'function';\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}