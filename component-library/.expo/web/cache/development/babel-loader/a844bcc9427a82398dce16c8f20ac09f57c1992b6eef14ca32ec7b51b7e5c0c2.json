{"ast":null,"code":"\"use strict\";\n\nvar _asyncToGenerator = require(\"@babel/runtime/helpers/asyncToGenerator\");\nvar _classCallCheck = require(\"@babel/runtime/helpers/classCallCheck\");\nvar _createClass = require(\"@babel/runtime/helpers/createClass\");\nvar _get = require(\"@babel/runtime/helpers/get\");\nvar _inherits = require(\"@babel/runtime/helpers/inherits\");\nvar _possibleConstructorReturn = require(\"@babel/runtime/helpers/possibleConstructorReturn\");\nvar _getPrototypeOf = require(\"@babel/runtime/helpers/getPrototypeOf\");\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar expo_pwa_1 = require(\"expo-pwa\");\nvar webpack_1 = require(\"webpack\");\nvar JsonWebpackPlugin_1 = __importDefault(require(\"./JsonWebpackPlugin\"));\nfunction maybeFetchPlugin(compiler, name) {\n  var _a, _b;\n  return (_b = (_a = compiler.options) === null || _a === void 0 ? void 0 : _a.plugins) === null || _b === void 0 ? void 0 : _b.map(function (_ref) {\n    var constructor = _ref.constructor;\n    return constructor;\n  }).find(function (constructor) {\n    return constructor && constructor.name === name;\n  });\n}\nvar PwaManifestWebpackPlugin = function (_JsonWebpackPlugin_1$) {\n  _inherits(PwaManifestWebpackPlugin, _JsonWebpackPlugin_1$);\n  var _super = _createSuper(PwaManifestWebpackPlugin);\n  function PwaManifestWebpackPlugin(pwaOptions, manifest) {\n    var _this;\n    _classCallCheck(this, PwaManifestWebpackPlugin);\n    _this = _super.call(this, {\n      path: pwaOptions.path,\n      json: manifest,\n      pretty: true\n    });\n    _this.pwaOptions = pwaOptions;\n    _this.rel = 'manifest';\n    return _this;\n  }\n  _createClass(PwaManifestWebpackPlugin, [{\n    key: \"apply\",\n    value: function apply(compiler) {\n      var _this2 = this;\n      _get(_getPrototypeOf(PwaManifestWebpackPlugin.prototype), \"apply\", this).call(this, compiler);\n      compiler.hooks.compilation.tap(this.constructor.name, function (compilation) {\n        compilation.hooks.processAssets.tapPromise({\n          name: _this2.constructor.name,\n          stage: webpack_1.Compilation.PROCESS_ASSETS_STAGE_ADDITIONAL\n        }, _asyncToGenerator(function* () {\n          var HtmlWebpackPlugin = maybeFetchPlugin(compiler, 'HtmlWebpackPlugin');\n          if (HtmlWebpackPlugin) {\n            if (typeof HtmlWebpackPlugin.getHooks === 'undefined') {\n              compilation.errors.push(new webpack_1.WebpackError('PwaManifestWebpackPlugin - This PwaManifestWebpackPlugin version is not compatible with your current HtmlWebpackPlugin version.\\n'));\n              return;\n            }\n            HtmlWebpackPlugin.getHooks(compilation).alterAssetTags.tapAsync(_this2.constructor.name, function (data, htmlCallback) {\n              var isInjectionAllowed;\n              if (typeof _this2.pwaOptions.inject === 'boolean') {\n                isInjectionAllowed = _this2.pwaOptions.inject;\n              } else if (typeof _this2.pwaOptions.inject === 'function') {\n                isInjectionAllowed = _this2.pwaOptions.inject(data.plugin);\n              } else {\n                isInjectionAllowed = data.plugin.options.pwaManifest !== false;\n              }\n              if (isInjectionAllowed === false) {\n                return htmlCallback(null, data);\n              }\n              data.assetTags.meta.push({\n                tagName: 'link',\n                voidTag: true,\n                attributes: {\n                  rel: _this2.rel,\n                  href: (0, expo_pwa_1.joinUrlPath)(_this2.pwaOptions.publicPath, _this2.pwaOptions.path)\n                }\n              });\n              htmlCallback(null, data);\n            });\n          }\n        }));\n      });\n    }\n  }]);\n  return PwaManifestWebpackPlugin;\n}(JsonWebpackPlugin_1.default);\nexports.default = PwaManifestWebpackPlugin;","map":{"version":3,"names":["expo_pwa_1","require","webpack_1","JsonWebpackPlugin_1","__importDefault","maybeFetchPlugin","compiler","name","_b","_a","options","plugins","map","_ref","constructor","find","PwaManifestWebpackPlugin","_JsonWebpackPlugin_1$","_inherits","_super","_createSuper","pwaOptions","manifest","_this","_classCallCheck","call","path","json","pretty","rel","_createClass","key","value","apply","_this2","_get","_getPrototypeOf","prototype","hooks","compilation","tap","processAssets","tapPromise","stage","Compilation","PROCESS_ASSETS_STAGE_ADDITIONAL","_asyncToGenerator","HtmlWebpackPlugin","getHooks","errors","push","WebpackError","alterAssetTags","tapAsync","data","htmlCallback","isInjectionAllowed","inject","plugin","pwaManifest","assetTags","meta","tagName","voidTag","attributes","href","joinUrlPath","publicPath","default","exports"],"sources":["/Users/henriqueeidt/Documents/Projects/poc-web-mobile-components/component-library/node_modules/@expo/webpack-config/src/plugins/PwaManifestWebpackPlugin.ts"],"sourcesContent":["import { joinUrlPath } from 'expo-pwa';\nimport { Compilation, Compiler, WebpackError, WebpackPluginInstance } from 'webpack';\n\nimport JsonWebpackPlugin from './JsonWebpackPlugin';\nimport { HTMLPluginData } from './ModifyHtmlWebpackPlugin';\n\nexport type Icon = {\n  src: string;\n  sizes: string;\n  type: 'image/png';\n};\n\nfunction maybeFetchPlugin(compiler: Compiler, name: string): WebpackPluginInstance | undefined {\n  return compiler.options?.plugins\n    ?.map(({ constructor }) => constructor)\n    .find(constructor => constructor && constructor.name === name);\n}\n\nexport type PwaManifestOptions = {\n  path: string;\n  inject?: boolean | Function;\n  publicPath: string;\n};\n\nexport default class PwaManifestWebpackPlugin extends JsonWebpackPlugin {\n  rel: string = 'manifest';\n\n  constructor(private pwaOptions: PwaManifestOptions, manifest: any) {\n    super({\n      path: pwaOptions.path,\n      json: manifest,\n      pretty: true,\n    });\n  }\n\n  apply(compiler: Compiler) {\n    super.apply(compiler);\n\n    compiler.hooks.compilation.tap(this.constructor.name, (compilation: Compilation) => {\n      compilation.hooks.processAssets.tapPromise(\n        {\n          name: this.constructor.name,\n          // https://github.com/webpack/webpack/blob/master/lib/Compilation.js#L3280\n          stage: Compilation.PROCESS_ASSETS_STAGE_ADDITIONAL,\n        },\n        async () => {\n          // Hook into the html-webpack-plugin processing and add the html\n          const HtmlWebpackPlugin = maybeFetchPlugin(compiler, 'HtmlWebpackPlugin') as any;\n          if (HtmlWebpackPlugin) {\n            if (typeof HtmlWebpackPlugin.getHooks === 'undefined') {\n              compilation.errors.push(\n                new WebpackError(\n                  'PwaManifestWebpackPlugin - This PwaManifestWebpackPlugin version is not compatible with your current HtmlWebpackPlugin version.\\n'\n                )\n              );\n              return;\n            }\n\n            HtmlWebpackPlugin.getHooks(compilation).alterAssetTags.tapAsync(\n              this.constructor.name,\n              (\n                data: HTMLPluginData,\n                htmlCallback: (error: Error | null, data: HTMLPluginData) => void\n              ) => {\n                // Skip if a custom injectFunction returns false or if\n                // the htmlWebpackPlugin options includes a `favicons: false` flag\n                let isInjectionAllowed: boolean;\n                if (typeof this.pwaOptions.inject === 'boolean') {\n                  isInjectionAllowed = this.pwaOptions.inject;\n                } else if (typeof this.pwaOptions.inject === 'function') {\n                  isInjectionAllowed = this.pwaOptions.inject(data.plugin);\n                } else {\n                  isInjectionAllowed = data.plugin.options.pwaManifest !== false;\n                }\n\n                if (isInjectionAllowed === false) {\n                  return htmlCallback(null, data);\n                }\n\n                data.assetTags.meta.push({\n                  tagName: 'link',\n                  voidTag: true,\n                  attributes: {\n                    rel: this.rel,\n                    href: joinUrlPath(this.pwaOptions.publicPath, this.pwaOptions.path),\n                  },\n                });\n\n                htmlCallback(null, data);\n              }\n            );\n          }\n        }\n      );\n    });\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}