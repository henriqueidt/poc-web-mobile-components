{"ast":null,"code":"\"use strict\";\n\nvar _toConsumableArray = require(\"@babel/runtime/helpers/toConsumableArray\");\nvar _slicedToArray = require(\"@babel/runtime/helpers/slicedToArray\");\nvar _classCallCheck = require(\"@babel/runtime/helpers/classCallCheck\");\nvar _createClass = require(\"@babel/runtime/helpers/createClass\");\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ModuleNotFoundPlugin = void 0;\nvar chalk_1 = __importDefault(require(\"chalk\"));\nvar find_up_1 = require(\"find-up\");\nvar path_1 = __importDefault(require(\"path\"));\nfunction isModuleNotFoundError(error) {\n  return (error === null || error === void 0 ? void 0 : error.name) === 'ModuleNotFoundError';\n}\nvar ModuleNotFoundPlugin = function () {\n  function ModuleNotFoundPlugin(appPath, yarnLockFile) {\n    _classCallCheck(this, ModuleNotFoundPlugin);\n    this.appPath = appPath;\n    this.yarnLockFile = yarnLockFile;\n    this.useYarnCommand = this.useYarnCommand.bind(this);\n    this.getRelativePath = this.getRelativePath.bind(this);\n    this.prettierError = this.prettierError.bind(this);\n  }\n  _createClass(ModuleNotFoundPlugin, [{\n    key: \"useYarnCommand\",\n    value: function useYarnCommand() {\n      try {\n        return (0, find_up_1.sync)('yarn.lock', {\n          cwd: this.appPath\n        }) != null;\n      } catch (_unused) {\n        return false;\n      }\n    }\n  }, {\n    key: \"getRelativePath\",\n    value: function getRelativePath(_file) {\n      var file = path_1.default.relative(this.appPath, _file);\n      if (file.startsWith('..')) {\n        file = _file;\n      } else if (!file.startsWith('.')) {\n        file = '.' + path_1.default.sep + file;\n      }\n      return file;\n    }\n  }, {\n    key: \"prettierError\",\n    value: function prettierError(err) {\n      var _a;\n      var _err$details = err.details,\n        _details = _err$details === void 0 ? '' : _err$details,\n        origin = err.origin;\n      if (origin == null) {\n        var caseSensitivity = err.message && /\\[CaseSensitivePathsPlugin\\] `(.*?)` .* `(.*?)`/.exec(err.message);\n        if (caseSensitivity) {\n          var _caseSensitivity = _slicedToArray(caseSensitivity, 3),\n            incorrectPath = _caseSensitivity[1],\n            actualName = _caseSensitivity[2];\n          var actualFile = this.getRelativePath(path_1.default.join(path_1.default.dirname(incorrectPath), actualName));\n          var incorrectName = path_1.default.basename(incorrectPath);\n          err.message = \"Cannot find file: '\" + incorrectName + \"' does not match the corresponding name on disk: '\" + actualFile + \"'.\";\n        }\n        return err;\n      }\n      var file = this.getRelativePath(origin.resource);\n      var details = _details.split('\\n');\n      var request = /resolve '(.*?)' in '(.*?)'/.exec(details);\n      if (request) {\n        var isModule = details[1] && details[1].includes('module');\n        var isFile = details[1] && details[1].includes('file');\n        var _request = _slicedToArray(request, 3),\n          target = _request[1],\n          context = _request[2];\n        context = this.getRelativePath(context);\n        if (isModule) {\n          var isYarn = this.useYarnCommand();\n          details = [\"Cannot find module: '\" + target + \"'. Make sure this package is installed.\", '', 'You can install this package by running: ' + (isYarn ? chalk_1.default.bold(\"yarn add \" + target) : chalk_1.default.bold(\"npm install \" + target)) + '.'];\n        } else if (isFile) {\n          details = [\"Cannot find file '\" + target + \"' in '\" + context + \"'.\"];\n        } else {\n          details = [err.message];\n        }\n      } else {\n        details = [err.message];\n      }\n      err.message = [file].concat(_toConsumableArray(details)).join('\\n').replace('Error: ', '');\n      var isModuleScopePluginError = (_a = err.error) === null || _a === void 0 ? void 0 : _a.__module_scope_plugin;\n      if (isModuleScopePluginError) {\n        err.message = err.message.replace('Module not found: ', '');\n      }\n      return err;\n    }\n  }, {\n    key: \"apply\",\n    value: function apply(compiler) {\n      var prettierError = this.prettierError;\n      compiler.hooks.make.intercept({\n        register: function register(tap) {\n          if (!(tap.name === 'MultiEntryPlugin' || tap.name === 'EntryPlugin')) {\n            return tap;\n          }\n          return Object.assign({}, tap, {\n            fn: function fn(compilation, callback) {\n              tap.fn(compilation, function (err) {\n                if (isModuleNotFoundError(err)) {\n                  err = prettierError(err);\n                }\n                for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n                  args[_key - 1] = arguments[_key];\n                }\n                callback.apply(void 0, [err].concat(args));\n              });\n            }\n          });\n        }\n      });\n    }\n  }]);\n  return ModuleNotFoundPlugin;\n}();\nexports.ModuleNotFoundPlugin = ModuleNotFoundPlugin;","map":{"version":3,"names":["chalk_1","__importDefault","require","find_up_1","path_1","isModuleNotFoundError","error","name","ModuleNotFoundPlugin","appPath","yarnLockFile","_classCallCheck","useYarnCommand","bind","getRelativePath","prettierError","_createClass","key","value","sync","cwd","_unused","_file","file","default","relative","startsWith","sep","err","_err$details","details","_details","origin","caseSensitivity","message","exec","_caseSensitivity","_slicedToArray","incorrectPath","actualName","actualFile","join","dirname","incorrectName","basename","resource","split","request","isModule","includes","isFile","_request","target","context","isYarn","bold","concat","_toConsumableArray","replace","isModuleScopePluginError","_a","__module_scope_plugin","apply","compiler","hooks","make","intercept","register","tap","Object","assign","fn","compilation","callback","_len","arguments","length","args","Array","_key","exports"],"sources":["/Users/henriqueeidt/Documents/Projects/poc-web-mobile-components/component-library/node_modules/@expo/webpack-config/src/plugins/ModuleNotFoundPlugin.ts"],"sourcesContent":["/**\n * Copyright (c) 2022 Expo, Inc.\n * Copyright (c) 2015-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * Based on https://github.com/facebook/create-react-app/blob/f0a837c/packages/react-dev-utils/ModuleNotFoundPlugin.js\n * But with Node LTS support and removed support for CaseSensitivePathsPlugin which we don't implement due to performance concerns.\n */\nimport chalk from 'chalk';\nimport { sync as findUpSync } from 'find-up';\nimport path from 'path';\nimport { Compilation, Compiler, WebpackError } from 'webpack';\n\ntype ModuleNotFoundError = WebpackError & {\n  details?: string;\n  error?: any;\n  resource: string;\n  origin: { resource: string };\n  message: string;\n};\n\nfunction isModuleNotFoundError(error: any): error is ModuleNotFoundError {\n  return error?.name === 'ModuleNotFoundError';\n}\n\nexport class ModuleNotFoundPlugin {\n  constructor(private appPath: string, private yarnLockFile?: string) {\n    this.useYarnCommand = this.useYarnCommand.bind(this);\n    this.getRelativePath = this.getRelativePath.bind(this);\n    this.prettierError = this.prettierError.bind(this);\n  }\n\n  private useYarnCommand() {\n    try {\n      return findUpSync('yarn.lock', { cwd: this.appPath }) != null;\n    } catch {\n      return false;\n    }\n  }\n\n  private getRelativePath(_file: string) {\n    let file = path.relative(this.appPath, _file);\n    if (file.startsWith('..')) {\n      file = _file;\n    } else if (!file.startsWith('.')) {\n      file = '.' + path.sep + file;\n    }\n    return file;\n  }\n\n  private prettierError(err: ModuleNotFoundError) {\n    const { details: _details = '', origin } = err;\n\n    if (origin == null) {\n      const caseSensitivity =\n        err.message && /\\[CaseSensitivePathsPlugin\\] `(.*?)` .* `(.*?)`/.exec(err.message);\n      if (caseSensitivity) {\n        const [, incorrectPath, actualName] = caseSensitivity;\n        const actualFile = this.getRelativePath(path.join(path.dirname(incorrectPath), actualName));\n        const incorrectName = path.basename(incorrectPath);\n        err.message = `Cannot find file: '${incorrectName}' does not match the corresponding name on disk: '${actualFile}'.`;\n      }\n      return err;\n    }\n\n    const file = this.getRelativePath(origin.resource);\n    // TODO: This looks like a type error...\n    let details = _details.split('\\n');\n\n    const request = /resolve '(.*?)' in '(.*?)'/.exec(details);\n    if (request) {\n      const isModule = details[1] && details[1].includes('module');\n      const isFile = details[1] && details[1].includes('file');\n\n      let [, target, context] = request;\n      context = this.getRelativePath(context);\n      if (isModule) {\n        const isYarn = this.useYarnCommand();\n        details = [\n          `Cannot find module: '${target}'. Make sure this package is installed.`,\n          '',\n          'You can install this package by running: ' +\n            (isYarn ? chalk.bold(`yarn add ${target}`) : chalk.bold(`npm install ${target}`)) +\n            '.',\n        ];\n      } else if (isFile) {\n        details = [`Cannot find file '${target}' in '${context}'.`];\n      } else {\n        details = [err.message];\n      }\n    } else {\n      details = [err.message];\n    }\n    err.message = [file, ...details].join('\\n').replace('Error: ', '');\n\n    const isModuleScopePluginError = err.error?.__module_scope_plugin;\n    if (isModuleScopePluginError) {\n      err.message = err.message.replace('Module not found: ', '');\n    }\n    return err;\n  }\n\n  apply(compiler: Compiler) {\n    const { prettierError } = this;\n    compiler.hooks.make.intercept({\n      register(tap) {\n        if (!(tap.name === 'MultiEntryPlugin' || tap.name === 'EntryPlugin')) {\n          return tap;\n        }\n        return Object.assign({}, tap, {\n          fn: (compilation: Compilation, callback: (error: any, ...args: unknown[]) => void) => {\n            tap.fn(compilation, (err: WebpackError, ...args: unknown[]) => {\n              if (isModuleNotFoundError(err)) {\n                err = prettierError(err);\n              }\n              callback(err, ...args);\n            });\n          },\n        });\n      },\n    });\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}