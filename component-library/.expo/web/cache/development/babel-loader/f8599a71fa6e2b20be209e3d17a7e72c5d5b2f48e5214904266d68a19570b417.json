{"ast":null,"code":"\"use strict\";\n\nvar _asyncToGenerator = require(\"@babel/runtime/helpers/asyncToGenerator\");\nvar _classCallCheck = require(\"@babel/runtime/helpers/classCallCheck\");\nvar _createClass = require(\"@babel/runtime/helpers/createClass\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar webpack_1 = require(\"webpack\");\nfunction maybeFetchPlugin(compiler, name) {\n  var _a, _b;\n  return (_b = (_a = compiler.options) === null || _a === void 0 ? void 0 : _a.plugins) === null || _b === void 0 ? void 0 : _b.map(function (_ref) {\n    var constructor = _ref.constructor;\n    return constructor;\n  }).find(function (constructor) {\n    return constructor && constructor.name === name;\n  });\n}\nvar ModifyHtmlWebpackPlugin = function () {\n  function ModifyHtmlWebpackPlugin() {\n    var modifyOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    _classCallCheck(this, ModifyHtmlWebpackPlugin);\n    this.modifyOptions = modifyOptions;\n  }\n  _createClass(ModifyHtmlWebpackPlugin, [{\n    key: \"modifyAsync\",\n    value: function () {\n      var _modifyAsync = _asyncToGenerator(function* (compiler, compilation, data) {\n        return data;\n      });\n      function modifyAsync(_x, _x2, _x3) {\n        return _modifyAsync.apply(this, arguments);\n      }\n      return modifyAsync;\n    }()\n  }, {\n    key: \"apply\",\n    value: function apply(compiler) {\n      var _this = this;\n      compiler.hooks.compilation.tap(this.constructor.name, function (compilation) {\n        compilation.hooks.processAssets.tapPromise({\n          name: _this.constructor.name,\n          stage: webpack_1.Compilation.PROCESS_ASSETS_STAGE_ADDITIONAL\n        }, _asyncToGenerator(function* () {\n          var HtmlWebpackPlugin = maybeFetchPlugin(compiler, 'HtmlWebpackPlugin');\n          if (HtmlWebpackPlugin) {\n            if (typeof HtmlWebpackPlugin.getHooks === 'undefined') {\n              compilation.errors.push(new webpack_1.WebpackError('ModifyHtmlWebpackPlugin - This ModifyHtmlWebpackPlugin version is not compatible with your current HtmlWebpackPlugin version.\\n'));\n              return;\n            }\n            HtmlWebpackPlugin.getHooks(compilation).alterAssetTags.tapAsync(_this.constructor.name, function () {\n              var _ref3 = _asyncToGenerator(function* (data, htmlCallback) {\n                var isInjectionAllowed = typeof _this.modifyOptions.inject === 'function' ? _this.modifyOptions.inject(data.plugin) : data.plugin.options.pwaManifest !== false;\n                if (isInjectionAllowed === false) {\n                  return htmlCallback(null, data);\n                }\n                try {\n                  data = yield _this.modifyAsync(compiler, compilation, data);\n                } catch (error) {\n                  compilation.errors.push(error);\n                }\n                htmlCallback(null, data);\n              });\n              return function (_x4, _x5) {\n                return _ref3.apply(this, arguments);\n              };\n            }());\n          }\n        }));\n      });\n    }\n  }]);\n  return ModifyHtmlWebpackPlugin;\n}();\nexports.default = ModifyHtmlWebpackPlugin;","map":{"version":3,"names":["webpack_1","require","maybeFetchPlugin","compiler","name","_b","_a","options","plugins","map","_ref","constructor","find","ModifyHtmlWebpackPlugin","modifyOptions","arguments","length","undefined","_classCallCheck","_createClass","key","value","_modifyAsync","_asyncToGenerator","compilation","data","modifyAsync","_x","_x2","_x3","apply","_this","hooks","tap","processAssets","tapPromise","stage","Compilation","PROCESS_ASSETS_STAGE_ADDITIONAL","HtmlWebpackPlugin","getHooks","errors","push","WebpackError","alterAssetTags","tapAsync","_ref3","htmlCallback","isInjectionAllowed","inject","plugin","pwaManifest","error","_x4","_x5","exports","default"],"sources":["/Users/henriqueeidt/Documents/Projects/poc-web-mobile-components/component-library/node_modules/@expo/webpack-config/src/plugins/ModifyHtmlWebpackPlugin.ts"],"sourcesContent":["import { Compilation, Compiler, WebpackError, WebpackPluginInstance } from 'webpack';\n\nfunction maybeFetchPlugin(compiler: Compiler, name: string): WebpackPluginInstance | undefined {\n  return compiler.options?.plugins\n    ?.map(({ constructor }) => constructor)\n    .find(constructor => constructor && constructor.name === name);\n}\n\nexport type HTMLPluginData = {\n  assetTags: any;\n  outputName: string;\n  plugin: any;\n};\n\nexport type HTMLLinkNode = {\n  rel?: string;\n  name?: string;\n  content?: string;\n  media?: string;\n  href?: string;\n  sizes?: string;\n  node: any;\n};\n\nexport default class ModifyHtmlWebpackPlugin {\n  constructor(private modifyOptions: { inject?: boolean | Function } = {}) {}\n\n  async modifyAsync(\n    compiler: Compiler,\n    compilation: Compilation,\n    data: HTMLPluginData\n  ): Promise<HTMLPluginData> {\n    return data;\n  }\n\n  apply(compiler: Compiler) {\n    compiler.hooks.compilation.tap(this.constructor.name, (compilation: Compilation) => {\n      compilation.hooks.processAssets.tapPromise(\n        {\n          name: this.constructor.name,\n          // https://github.com/webpack/webpack/blob/master/lib/Compilation.js#L3280\n          stage: Compilation.PROCESS_ASSETS_STAGE_ADDITIONAL,\n        },\n        async () => {\n          // Hook into the html-webpack-plugin processing and add the html\n          const HtmlWebpackPlugin = maybeFetchPlugin(compiler, 'HtmlWebpackPlugin') as any;\n          if (HtmlWebpackPlugin) {\n            if (typeof HtmlWebpackPlugin.getHooks === 'undefined') {\n              compilation.errors.push(\n                new WebpackError(\n                  'ModifyHtmlWebpackPlugin - This ModifyHtmlWebpackPlugin version is not compatible with your current HtmlWebpackPlugin version.\\n'\n                )\n              );\n              return;\n            }\n\n            HtmlWebpackPlugin.getHooks(compilation).alterAssetTags.tapAsync(\n              this.constructor.name,\n              async (\n                data: HTMLPluginData,\n                htmlCallback: (error: Error | null, data: HTMLPluginData) => void\n              ) => {\n                // Skip if a custom injectFunction returns false or if\n                // the htmlWebpackPlugin optuons includes a `favicons: false` flag\n                const isInjectionAllowed =\n                  typeof this.modifyOptions.inject === 'function'\n                    ? this.modifyOptions.inject(data.plugin)\n                    : data.plugin.options.pwaManifest !== false;\n\n                if (isInjectionAllowed === false) {\n                  return htmlCallback(null, data);\n                }\n\n                try {\n                  data = await this.modifyAsync(compiler, compilation, data);\n                } catch (error: any) {\n                  compilation.errors.push(error);\n                }\n\n                htmlCallback(null, data);\n              }\n            );\n          }\n        }\n      );\n    });\n  }\n}\n"],"mappings":";;;;;;;;AAAA,IAAAA,SAAA,GAAAC,OAAA;AAEA,SAASC,gBAAgBA,CAACC,QAAkB,EAAEC,IAAY;;EACxD,OAAO,CAAAC,EAAA,IAAAC,EAAA,GAAAH,QAAQ,CAACI,OAAO,cAAAD,EAAA,uBAAAA,EAAA,CAAEE,OAAO,cAAAH,EAAA,uBAAAA,EAAA,CAC5BI,GAAG,CAAC,UAAAC,IAAA;IAAA,IAAGC,WAAW,GAAAD,IAAA,CAAXC,WAAW;IAAA,OAAOA,WAAW;EAAA,GACrCC,IAAI,CAAC,UAAAD,WAAW;IAAA,OAAIA,WAAW,IAAIA,WAAW,CAACP,IAAI,KAAKA,IAAI;EAAA,EAAC;AAClE;AAAC,IAkBoBS,uBAAuB;EAC1C,SAAAA,wBAAA,EAAuE;IAAA,IAAnDC,aAAA,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAiD,EAAE;IAAAG,eAAA,OAAAL,uBAAA;IAAnD,KAAAC,aAAa,GAAbA,aAAa;EAAyC;EAACK,YAAA,CAAAN,uBAAA;IAAAO,GAAA;IAAAC,KAAA;MAAA,IAAAC,YAAA,GAAAC,iBAAA,CAE3E,WACEpB,QAAkB,EAClBqB,WAAwB,EACxBC,IAAoB;QAEpB,OAAOA,IAAI;MACb,CAAC;MAAA,SAAAC,YAAAC,EAAA,EAAAC,GAAA,EAAAC,GAAA;QAAA,OAAAP,YAAA,CAAAQ,KAAA,OAAAf,SAAA;MAAA;MAAA,OAAAW,WAAA;IAAA;EAAA;IAAAN,GAAA;IAAAC,KAAA,EAED,SAAAS,MAAM3B,QAAkB;MAAA,IAAA4B,KAAA;MACtB5B,QAAQ,CAAC6B,KAAK,CAACR,WAAW,CAACS,GAAG,CAAC,IAAI,CAACtB,WAAW,CAACP,IAAI,EAAE,UAACoB,WAAwB,EAAI;QACjFA,WAAW,CAACQ,KAAK,CAACE,aAAa,CAACC,UAAU,CACxC;UACE/B,IAAI,EAAE2B,KAAI,CAACpB,WAAW,CAACP,IAAI;UAE3BgC,KAAK,EAAEpC,SAAA,CAAAqC,WAAW,CAACC;SACpB,EAAAf,iBAAA,CACD,aAAW;UAET,IAAMgB,iBAAiB,GAAGrC,gBAAgB,CAACC,QAAQ,EAAE,mBAAmB,CAAQ;UAChF,IAAIoC,iBAAiB,EAAE;YACrB,IAAI,OAAOA,iBAAiB,CAACC,QAAQ,KAAK,WAAW,EAAE;cACrDhB,WAAW,CAACiB,MAAM,CAACC,IAAI,CACrB,IAAI1C,SAAA,CAAA2C,YAAY,CACd,iIAAiI,CAClI,CACF;cACD;;YAGFJ,iBAAiB,CAACC,QAAQ,CAAChB,WAAW,CAAC,CAACoB,cAAc,CAACC,QAAQ,CAC7Dd,KAAI,CAACpB,WAAW,CAACP,IAAI;cAAA,IAAA0C,KAAA,GAAAvB,iBAAA,CACrB,WACEE,IAAoB,EACpBsB,YAAiE,EAC/D;gBAGF,IAAMC,kBAAkB,GACtB,OAAOjB,KAAI,CAACjB,aAAa,CAACmC,MAAM,KAAK,UAAU,GAC3ClB,KAAI,CAACjB,aAAa,CAACmC,MAAM,CAACxB,IAAI,CAACyB,MAAM,CAAC,GACtCzB,IAAI,CAACyB,MAAM,CAAC3C,OAAO,CAAC4C,WAAW,KAAK,KAAK;gBAE/C,IAAIH,kBAAkB,KAAK,KAAK,EAAE;kBAChC,OAAOD,YAAY,CAAC,IAAI,EAAEtB,IAAI,CAAC;;gBAGjC,IAAI;kBACFA,IAAI,SAASM,KAAI,CAACL,WAAW,CAACvB,QAAQ,EAAEqB,WAAW,EAAEC,IAAI,CAAC;iBAC3D,CAAC,OAAO2B,KAAU,EAAE;kBACnB5B,WAAW,CAACiB,MAAM,CAACC,IAAI,CAACU,KAAK,CAAC;;gBAGhCL,YAAY,CAAC,IAAI,EAAEtB,IAAI,CAAC;cAC1B,CAAC;cAAA,iBAAA4B,GAAA,EAAAC,GAAA;gBAAA,OAAAR,KAAA,CAAAhB,KAAA,OAAAf,SAAA;cAAA;YAAA,IACF;;QAEL,CAAC,EACF;MACH,CAAC,CAAC;IACJ;EAAC;EAAA,OAAAF,uBAAA;AAAA;AA9DH0C,OAAA,CAAAC,OAAA,GAAA3C,uBAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}